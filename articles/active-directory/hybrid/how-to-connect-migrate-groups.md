---
title: 'Azure AD Connect: Csoportok áttelepítése egyik erdőből a másikba | Microsoft dokumentumok'
description: Ez a cikk ismerteti a csoportok sikeres áttelepítéséhez szükséges csoportok egyik erdőből a másikba az Azure AD Connect.
services: active-directory
author: billmath
manager: daveba
ms.service: active-directory
ms.topic: reference
ms.workload: identity
ms.date: 04/02/2020
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 298cfa58d008fbeb0d58cdcff61b27fa1819ee1d
ms.sourcegitcommit: bc738d2986f9d9601921baf9dded778853489b16
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/02/2020
ms.locfileid: "80620830"
---
# <a name="migrate-groups-from-one-forest-to-another-for-azure-ad-connect"></a>Csoportok áttelepítése egyik erdőből a másikba az Azure AD Connect számára

Ez a cikk azokat a lépéseket ismerteti, amelyek a csoportok egyik erdőből a másikba történő sikeres áttelepítéséhez szükségesek, hogy az áttelepített csoportobjektumok megegyezhessenek a felhőben meglévő objektumokkal.

## <a name="prerequisites"></a>Előfeltételek

- Az Azure AD Connect 1.5.18.0-s vagy újabb verziója
- A Forráshorgony attribútum`mS-DS-ConsistencyGuid`

Az 1.5.18.0-s verziótól kezdve az Azure `mS-DS-ConsistencyGuid` AD Connect elkezdte támogatni a csoportok használatát. Ha `mS-DS-ConsistencyGuid` a forráshorgony attribútumaként van kiválasztva, és az érték az AD-ben van feltöltve, az Azure AD Connect az értéket használja nem `mS-DS-ConsistencyGuid` módosíthatóazonosítóként. Ellenkező esetben visszaesik `objectGUID`a . Azonban vegye figyelembe, hogy **DOES NOT** az Azure AD Connect `mS-DS-ConsistencyGuid` nem írja vissza az értéket az ad-beli attribútumhoz.

Erdőközi áthelyezési forgatókönyv esetén, amikor egy csoportobjektum az egyik erdőből (mondjuk F1) egy másik `mS-DS-ConsistencyGuid` erdőbe (például `objectGUID` F2) kerül át, `mS-DS-ConsistencyGuid` át kell másolnunk az F1 erdőben lévő objektum értékét az F2-ben lévő objektum attribútumát. 

A következő parancsfájlok használata iránymutatásként, hogy hogyan lehet egyetlen csoportot áttelepíteni az F1 erdőből az F2 erdőbe. Kérjük, használja ezt iránymutatásként, hogy nem a migráció több csoport számára.

Először is, `objectGUID` `mS-DS-ConsistencyGuid` megkapjuk a és a csoport objektum erdőben F1. Ezeket az attribútumokat a rendszer CSV-fájlba exportálja.
```
<#
DESCRIPTION
============
This script will take DN of a group as input.
It then copies the objectGUID and mS-DS-ConsistencyGuid values along with other attributes of the given group to a CSV file.

This CSV file can then be used as input to Export-Group script
#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $outputCsv
)

$defaultProperties = @('samAccountName', 'distinguishedName', 'objectGUID', 'mS-DS-ConsistencyGuid')
$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -Properties $defaultProperties -ErrorAction Stop
$results = @()
if ($group -eq $null)
{
       Write-Error "Group not found"
}
else
{
       $objectGUIDValue = [GUID]$group.'objectGUID'
       $mSDSConsistencyGuidValue = "N/A"
       if ($group.'mS-DS-ConsistencyGuid' -ne $null)
       {
              $mSDSConsistencyGuidValue = [GUID]$group.'mS-DS-ConsistencyGuid'
       }
       $adgroup = New-Object -TypeName PSObject
       $adgroup | Add-Member -MemberType NoteProperty -Name samAccountName -Value $($group.'samAccountName')
       $adgroup | Add-Member -MemberType NoteProperty -Name distinguishedName -Value $($group.'distinguishedName')
       $adgroup | Add-Member -MemberType NoteProperty -Name objectGUID -Value $($objectGUIDValue)
       $adgroup | Add-Member -MemberType NoteProperty -Name mS-DS-ConsistencyGuid -Value $($mSDSConsistencyGuidValue)
       $results += $adgroup
}

Write-Host "Exporting group to output file"
$results | Export-Csv "$outputCsv" -NoTypeInformation

```

Ezután a létrehozott kimeneti CSV-fájlt `mS-DS-ConsistencyGuid` használjuk az Attribútum bélyegzőjéhez az F2 erdőben lévő célobjektumon.


```
<#
DESCRIPTION
============
This script will take DN of a group as input and the CSV file that was generated by Import-Group script
It copies either the objectGUID or mS-DS-ConsistencyGuid value from CSV file to the given object.

#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $inputCsv
)

$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -ErrorAction Stop
if ($group -eq $null)
{
       Write-Error "Group not found"
}

$csvFile = Import-Csv -Path $inputCsv -ErrorAction Stop
$msDSConsistencyGuid = [GUID] $csvFile.'mS-DS-ConsistencyGuid'
$objectGuid = [GUID] $csvFile.'objectGUID'
$targetGuid = $msDSConsistencyGuid

if ($msDSConsistencyGuid -eq "N/A")
{
       $targetGuid = $objectGuid
}

Set-ADGroup -Identity $dn -Replace @{'mS-DS-ConsistencyGuid'=$targetGuid} -ErrorAction Stop

```

## <a name="next-steps"></a>További lépések
További információ: [Helyszíni identitások integrálása az Azure Active Directoryval](whatis-hybrid-identity.md).
