---
title: Üzenetek, hasznos adatok és szerializálás Azure Service Bus | Microsoft Docs
description: Ez a cikk áttekinti a Azure Service Bus üzeneteket, a hasznos adatokat, az üzenet-útválasztást és a szerializálást.
services: service-bus-messaging
documentationcenter: ''
author: axisc
manager: timlt
editor: spelluru
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2020
ms.author: aschhab
ms.openlocfilehash: 11e56ae2483a254fb00e3593da7841f3f3d844f3
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/28/2020
ms.locfileid: "76759397"
---
# <a name="messages-payloads-and-serialization"></a>Üzenetek, hasznos adatforgalom és szerializáció

Microsoft Azure Service Bus kezeli az üzeneteket. Az üzenetek a kulcs-érték párok tulajdonságai, a hasznos adatok leírása és a Service Bus és alkalmazások kezelési utasításai formájában kezelik a hasznos adatokat, valamint a metaadatokat. Alkalmanként, hogy a metaadatok önmagában elegendőek ahhoz, hogy a küldőnek kommunikálni tudjon a fogadókkal, és a hasznos adatok üresek maradnak.

A .NET-hez és a Javához készült hivatalos Service Bus-ügyfelek objektummodell az absztrakt Service Bus üzenet szerkezetét tükrözi, amely az Service Bus által támogatott vezetékes protokollokra van leképezve.
 
Service Bus üzenet bináris adattartalomból álló szakaszból áll, amely Service Bus soha nem kezel semmilyen formában a szolgáltatás és a tulajdonságok két készletét. A *közvetítő tulajdonságait* a rendszer előre definiálja. Ezek az előre definiált tulajdonságok vezérlik a közvetítőn belüli üzenet-szintű funkciókat, vagy közös és szabványosított metaadat-elemekre mutatnak. A *felhasználói tulajdonságok* olyan kulcs-érték párok gyűjteményei, amelyek az alkalmazás által meghatározhatók és állíthatók be.
 
Az előre definiált közvetítő tulajdonságai az alábbi táblázatban láthatók. A nevek az összes hivatalos ügyféloldali API-val és a HTTP-protokoll leképezésének [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) JSON-objektumában is szerepelnek.
 
A AMQP protokoll szintjén használt egyenértékű nevek zárójelben vannak felsorolva. 

| Tulajdonság neve                         | Leírás                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (Content-Type)           | Opcionálisan leírja az üzenet tartalmát a RFC2045 formátumát követő leíróval, 5. szakasz; például: `application/json`.                                                                                                                                                                                                                                                                                             |
|  [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (korrelációs azonosító)       | Lehetővé teszi az alkalmazás számára, hogy korrelációs célból megismertesse az üzenet környezetét. például egy olyan üzenet **MessageID** , amelyről válaszol.                                                                                                                                                                                                                                                                  |
| [DeadLetterSource](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Csak a kézbesítetlen üzenetekből és a kézbesítetlen levelek várólistáról egy másik entitásba automatikusan továbbított üzenetekben van beállítva. Azt az entitást jelzi, amelyben az üzenet el lett kézbesítve. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                  |
| [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Az üzenethez megkísérelt kézbesítések száma. Ha egy üzenet zárolása lejár, vagy a fogadó explicit módon megszakította az üzenetet, a szám növekszik. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                                  |
| [EnqueuedSequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | A automatikusan továbbított üzenetek esetében ez a tulajdonság azt a sorszámot tükrözi, amely az eredeti beküldési pontnál először lett hozzárendelve az üzenethez. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                                                |
| [EnqueuedTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | Az az UTC-pillanat, amikor az üzenet el lett fogadva és tárolva lett az entitásban. Ez az érték mérvadó és semleges beérkezési időjelzőként is használható, ha a fogadó nem szeretné megbízni a küldő óráját. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                   |
|  [ExpiresAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (abszolút – lejárati idő) | Az az UTC-pillanat, amikor az üzenet eltávolításra van megjelölve, és a lejárata miatt már nem érhető el az entitásból való lekéréshez. A lejáratot a **TimeToLive** tulajdonság szabályozza, és ezt a tulajdonságot a EnqueuedTimeUtc + TimeToLive számítja ki. Ez a tulajdonság csak olvasható.                                                                                                                                                                           |
| [ForcePersistence](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | A [EnableExpress](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) jelzővel rendelkező várólisták vagy témakörök esetében ez a tulajdonság beállítható úgy, hogy a rendszer a nyugtát megelőzően megőrzi az üzenetet a lemez számára. Ez az összes nem expressz entitás szokásos viselkedése.                                                                                                                                                                                                         |
| [Címke](/dotnet/api/microsoft.azure.servicebus.message.label) (tárgy)                       | Ez a tulajdonság lehetővé teszi, hogy az alkalmazás szabványosított módon jelezze az üzenet célját a fogadónak, hasonlóan az e-mail tárgyához.                                                                                                                                                                                                                                                                                  |
| [LockedUntilUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | A zárolás alatt beolvasott üzenetek esetében (betekintési fogadási mód, nincs előre elrendezve) Ez a tulajdonság azt az UTC-azonnali időpontot mutatja, ameddig az üzenet zárolva van az üzenetsor/előfizetés szolgáltatásban. Ha a zárolás lejár, a [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) megnő, és az üzenet ismét elérhető lesz a lekéréshez. Ez a tulajdonság csak olvasható.                                                                                                                         |
| [LockToken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | A zárolási token egy hivatkozás arra a zárolásra, amelyet a közvetítő a *Peek-Lock* fogadási módban tart. A [jogkivonat a késleltető API-](message-deferral.md) n keresztül véglegesen rögzítheti a zárolást, és ezzel az üzenetet elküldheti a normál kézbesítési állapot folyamatáról. Ez a tulajdonság csak olvasható.                                                                                                                                                               |
| [MessageID](/dotnet/api/microsoft.azure.servicebus.message.messageid) (üzenet-azonosító)                | Az üzenet azonosítója egy olyan alkalmazás által definiált érték, amely egyedileg azonosítja az üzenetet és annak hasznos adatait. Az azonosító egy szabad formátumú karakterlánc, amely egy GUID azonosítót vagy egy alkalmazási környezetből származtatott azonosítót tükröz. Ha engedélyezve van, a [duplikált észlelési](duplicate-detection.md) funkció azonosítja és eltávolítja az azonos **MessageID**rendelkező üzenetek második és további beadványait.                                                                |
| [PartitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | [Particionált entitások](service-bus-partitioning.md)esetén az érték beállítása lehetővé teszi a kapcsolódó üzenetek ugyanahhoz a belső partícióhoz való hozzárendelését, így a beküldési sorrend megfelelően rögzítve lesz. A partíciót ezt az értéket egy kivonatoló függvény választja, és nem lehet közvetlenül kiválasztani. A munkamenet-kompatibilis entitások esetében az **munkamenet** -kezelő tulajdonság felülbírálja ezt az értéket.                                                                                                       |
| [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) (válasz – címzett)                    | Ez a választható és az alkalmazás által definiált érték szabványos módszer az üzenet fogadója számára a válasz elérési útjának kifejezésére. Ha a küldő választ vár a válaszra, a várólista vagy témakör abszolút vagy relatív elérési útjára állítja az értéket, amely a válasz küldésére vár.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (válasz-csoport-azonosító)  | Ez az érték fokozza a **ReplyTo** adatait, és megadja, hogy melyik **munkamenet** -azonosítót kell beállítani a válaszhoz a válasz entitásba való küldéskor.                                                                                                                                                                                                                                                                            |
| [ScheduledEnqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Azon üzenetek esetében, amelyek csak késés után érhetők el a lekéréshez, ez a tulajdonság határozza meg azt az UTC-pillanatot, amelyen az üzenet logikailag várólistán lévő, sorba kerül, és így elérhetővé válik a lekéréshez.                                                                                                                                                                                                                 |
| [Sorszám](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | A sorozatszám egy egyedi, 64 bites egész szám, amelyet a közvetítő elfogad és tárol, és igaz azonosítóként működik. Particionált entitások esetén a legfelső 16 bit a partíció azonosítóját tükrözi. A sorozatszámok monoton módon növekszik és szünetmentes. Ezek a 0 értéket adják át, ha az 48-64-es bites tartomány kimerült. Ez a tulajdonság csak olvasható.                                                                |
| [Munkamenet](/dotnet/api/microsoft.azure.servicebus.message.sessionid) -azonosító (csoport azonosítója)                  | A munkamenet-kompatibilis entitások esetében ez az alkalmazás által definiált érték határozza meg az üzenet munkamenet-kapcsolatát. Az ugyanazzal a munkamenet-azonosítóval rendelkező üzenetek összefoglaló zárolást kapnak, és lehetővé teszik a pontos, Megrendeléses feldolgozást és demultiplexet. A nem munkamenet-kompatibilis entitások esetén ez az érték figyelmen kívül lesz hagyva.                                                                                                                                     |
| [Méret](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | A a brókeri naplóban lévő üzenet tárolt méretét adja vissza bájtok számaként, ahogy az a tárolási kvóta felé mutat. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                                                                                       |
| [Állapot](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Jelzi az üzenet állapotát a naplóban. Ez a tulajdonság csak az üzenetek tallózása ("betekintés") esetén érvényes, annak megállapításához, hogy az üzenet "aktív"-e, és elérhető-e a lekéréshez, mert az a várólista elejére ér, akár elhalasztják, akár ütemezve van. Ez a tulajdonság csak olvasható.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Ez az érték azt a relatív időtartamot jelöli, amely után az üzenet lejár, és az üzenet elfogadását és tárolását a közvetítő a **EnqueueTimeUtc**-ben rögzítettnek tekinti. Ha nincs beállítva explicit módon, a feltételezett érték az adott várólista vagy témakör **DefaultTimeToLive** . Az üzenet szintű **TimeToLive** értéke nem lehet hosszabb, mint az entitás **DefaultTimeToLive** beállítása. Ha a szolgáltatás már nem érhető el, az csendesen van módosítva. |
| Ide [(to](/dotnet/api/microsoft.azure.servicebus.message.to) )                               | Ez a tulajdonság az útválasztási forgatókönyvekben a későbbi használatra van fenntartva, és maga a közvetítő is figyelmen kívül hagyja. Az alkalmazások használhatják ezt az értéket a szabályok által vezérelt automatikus továbbítási láncolási forgatókönyvekben az üzenet kívánt logikai céljának jelzésére.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Ha egy tranzakció hatókörében egy adatátviteli várólistán keresztül küldenek üzenetet, akkor ez az érték az átviteli várólista partícióját jelöli.                                                                                                                                                                                                                                                                                                                 |

Az absztrakt üzenet modellje lehetővé teszi, hogy egy üzenet HTTP-n keresztül (valójában HTTPS) legyen közzétéve, és a AMQP keresztül is lekérhető. Az üzenet mindkét esetben normálisnak tűnik a megfelelő protokoll kontextusában. A közvetítő tulajdonságait szükség szerint lefordítjuk, és a felhasználói tulajdonságok a megfelelő protokoll-üzenet modell legmegfelelőbb helyére vannak leképezve. A HTTP-ben a felhasználói tulajdonságok a HTTP-fejlécek és azok között közvetlenül a következőre mutatnak: a AMQP a és az **alkalmazás-tulajdonságok** leképezésből is leképeznek.

## <a name="message-routing-and-correlation"></a>Üzenet-útválasztás és korreláció

A korábbi, kifejezetten [a](/dotnet/api/microsoft.azure.servicebus.message.to), a [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto), a [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), a [MessageID](/dotnet/api/microsoft.azure.servicebus.message.messageid), a [correlationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid)és a [munkamenet](/dotnet/api/microsoft.azure.servicebus.message.sessionid)-azonosítók által ismertetett bróker-tulajdonságok egy részhalmaza segíti az alkalmazások az üzenetek adott célhelyre való továbbítását. Ennek szemléltetéséhez Vegyünk néhány mintázatot:

- **Egyszerű kérelem/válasz**: a közzétevő üzenetet küld egy várólistába, és választ vár az üzenet felhasználója számára. A válasz fogadásához a közzétevőnek van egy várólistája, amelyben a válaszok kézbesítésére vár. A várólista címe a kimenő üzenet **ReplyTo** tulajdonságában van kifejezve. Amikor a fogyasztó válaszol, átmásolja a kezelt üzenet **MessageID** a **correlationId** tulajdonságba, és továbbítja az üzenetet a **ReplyTo** tulajdonság által jelzett célra. Az alkalmazási környezettől függően az egyik üzenet több választ is eredményezhet.
- **Csoportos küldési kérelem/válasz**: az előző minta változatában a közzétevő egy témakörbe küldi az üzenetet, és több előfizető jogosult az üzenet felhasználására. Mindegyik előfizető a korábban leírt módon válaszolhat. Ez a minta a felderítési vagy a hívási helyzetekben használatos, és a válaszadó általában azonosítja magát egy felhasználói tulajdonsággal vagy a hasznos adatokon belül. Ha a **ReplyTo** egy témakörre mutat, az ilyen típusú felderítési válaszok eloszthatók a célközönségbe.
- **Multiplexing**: Ez a munkamenet-szolgáltatás lehetővé teszi a kapcsolódó üzenetek összevonását egyetlen üzenetsor vagy előfizetés segítségével, így a kapcsolódó üzenetek minden munkamenete (vagy csoportja) a megadott **munkamenet** -azonosítók értékeivel azonosítva, egy adott fogadóba, miközben a fogadó a zárolás alatt tárolja a munkamenetet. A munkamenetek részleteiről [itt](message-sessions.md)olvashat bővebben.
- Többszintű **kérelem/válasz**: Ez a munkamenet-funkció lehetővé teszi a többszörös válaszokat, így több közzétevő is megoszthatja a válasz-várólistát. A **ReplyToSessionId**beállításával a közzétevő arra utasíthatja a fogyasztó (ka) t, hogy másolja ezt az értéket a válaszüzenet **munkamenet** -tulajdonságára. A közzétételi várólistának vagy témakörnek nem kell munkamenet-kompatibilisnek lennie. Az üzenet elküldésekor a közzétevő kimondottan megvárhatja, hogy a megadott munkamenet-azonosítóval rendelkező munkamenet egy **munkamenet-fogadó** feltételes elfogadásával megvalósuljon a várólistán. 

A Service Bus névteren belüli útválasztást az automatikus továbbítási láncolás és a témakör előfizetési szabályai segítségével lehet megvalósítani. A névterek közötti útválasztás az [Azure LogicApps használatával](https://azure.microsoft.com/services/logic-apps/)valósítható meg. Ahogy az előző listában is szerepel, a **to** tulajdonság későbbi használatra van fenntartva, és végül a közvetítő egy speciálisan engedélyezett funkcióval értelmezhető. Az útválasztást megvalósítani kívánt alkalmazásoknak a felhasználói tulajdonságok alapján kell megtenniük, és nem **a tulajdonságra** kell támaszkodnia. Ezzel azonban most nem fog kompatibilitási problémákat okozni.

## <a name="payload-serialization"></a>Hasznos adatok szerializálása

Ha az átvitel során vagy a Service Bus belsejében tárolja a hasznos adatokat, a rendszer mindig átlátszatlan, bináris blokkot tárol. A [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) tulajdonság lehetővé teszi az alkalmazások számára, hogy írják le a hasznos adatokat, a tulajdonságértékek javasolt formátuma pedig az IETF RFC2045; szerinti MIME-tartalomtípus leírása. például: `application/json;charset=utf-8`.

A Java-vagy .NET Standard változatokkal ellentétben a Service Bus API .NET-keretrendszerbeli verziója támogatja a **BrokeredMessage** -példányok létrehozását azáltal, hogy tetszőleges .net-objektumokat továbbít a konstruktorba. 

Az örökölt SBMP protokoll használatakor ezeket az objektumokat a rendszer az alapértelmezett bináris szerializáló használatával szerializálja, vagy egy külsőleg megadott szerializáló segítségével. Az AMQP protokoll használatakor az objektum szerializálva lesz egy AMQP objektumba. A fogadó lekérheti ezeket az objektumokat [a\<GetBody T> ()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) metódussal, amely megadja a várt típust. A AMQP-ben az objektumok szerializálva lesznek a **ArrayList** és a IDictionary AMQP-gráfba, **<sztringek** , objektumok>objektumok, és minden AMQP-ügyfél dekódolni tudja őket. 

Habár ez a rejtett szerializálási varázslat kényelmes, az alkalmazásoknak explicit módon át kell irányítani az objektumok szerializálását, és el kell végezniük az objektumok gráfait, mielőtt azok bekerülnek egy üzenetbe, és megfordítják a fogadó oldalát. Ez a művelet interoperábilis eredményeket eredményez. Azt is figyelembe kell venni, hogy míg a AMQP egy hatékony bináris kódolási modellel rendelkezik, a AMQP üzenetkezelési ökoszisztémához kötődik, és a HTTP-ügyfeleknek problémát okoz a hasznos adatok dekódolása. 

A rendszer általában a JSON-és az Apache-Avro ajánlja a strukturált adatok hasznos adataihoz.

A .NET Standard és a Java API-változatok csak a bájtos tömböket fogadják el, ami azt jelenti, hogy az alkalmazásnak kezelnie kell az objektum szerializálási vezérlőjét. 

## <a name="next-steps"></a>További lépések

Az Service Bus üzenetkezeléssel kapcsolatos további tudnivalókért tekintse meg a következő témaköröket:

* [Service Bus queues, topics, and subscriptions (Service Bus-üzenetsorok, -témakörök és -előfizetések)](service-bus-queues-topics-subscriptions.md)
* [Bevezetés a Service Bus által kezelt üzenetsorok használatába](service-bus-dotnet-get-started-with-queues.md)
* [A Service Bus-üzenettémakörök és -előfizetések használata](service-bus-dotnet-how-to-use-topics-subscriptions.md)
