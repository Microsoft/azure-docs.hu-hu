---
title: Azure Service Bus üzenetek, hasznos mailek és szerializálási | Microsoft Docs
description: Ez a cikk áttekintést nyújt a Azure Service Bus üzenetekről, hasznos adatokról, az üzenetek útválasztásról és szerializálásról.
ms.topic: article
ms.date: 04/14/2021
ms.openlocfilehash: 2ed65054f61aee4b9fb6157fc7a36e469c7a672c
ms.sourcegitcommit: db925ea0af071d2c81b7f0ae89464214f8167505
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 04/15/2021
ms.locfileid: "107515294"
---
# <a name="messages-payloads-and-serialization"></a>Üzenetek, hasznos adatforgalom és szerializáció

Microsoft Azure Service Bus kezeli az üzeneteket. Az üzenetek hasznos adatokat és metaadatokat tartalmaznak. A metaadatok kulcs-érték pártulajdonságok formájában formában adatokat tartalmaznak, és ismertetik a hasznos adatokat, valamint kezelési utasításokat Service Bus alkalmazásokhoz. Előfordulhat, hogy a metaadatok önmagában elegendőek ahhoz, hogy a küldő kommunikáljon a címzettekkel kommunikálni kívánó információkkal, és a hasznos adatok üresek maradnak.

A .NET és a Java hivatalos Service Bus-ügyfeleinek objektummodellje az absztrakt Service Bus-üzenetstruktúrát tükrözi, amely az által támogatott hálózati protokollokra és protokollokra van Service Bus leképezve.
 
A Service Bus üzenet egy bináris hasznos adatok szakaszból áll, Service Bus soha nem kezel semmilyen formában a szolgáltatásoldalon, és két tulajdonságkészletből áll. A *közvetítő tulajdonságait* a rendszer előre definiálta. Ezek az előre meghatározott tulajdonságok vagy a közvetítő üzenetszintű funkcióit irányítják, vagy általános és szabványos metaadatelemekre vannak leképezve. A *felhasználói tulajdonságok* kulcs-érték párok gyűjteményei, amelyek az alkalmazás által definiálhatóak és beállíthatók.
 
Az előre definiált közvetítőtulajdonságok az alábbi táblázatban vannak felsorolva. A neveket a rendszer az összes hivatalos ügyfél API-val, valamint a HTTP protokollleképezés [BrokerProperties](https://docs.microsoft.com/rest/api/servicebus/introduction) JSON objektumában is használja.
 
Az AMQP protokoll szintjén használt egyenértékű nevek zárójelben vannak felsorolva. Bár az alábbi nevek a cas-t használják, vegye figyelembe, hogy a JavaScript- és Python-ügyfelek camel és casing típusú kis- és kódot használnak.

| Tulajdonság neve                         | Leírás                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `ContentType` (tartalomtípus)           | Opcionálisan leírja az üzenet hasznos adatát az RFC2045 5. szakasz formátumát követő leíróval; például: `application/json` .                                                                                                                                                                                                                                                                                             |
| `CorrelationId` (korrelációs azonosító)       | Lehetővé teszi, hogy az alkalmazás megad egy környezetet az üzenethez korreláció céljából; például egy olyan üzenet **MessageId-ját** tükrözve, amelybe a rendszer áttért.                                                                                                                                                                                                                                                                  |
| `DeadLetterSource`                      | Csak olyan üzenetekben állítsa be a halmazt, amelyek a nem szöveges üzenetsorból automatikusan át vannak állítva egy másik entitásra. Azt az entitást jelzi, amelyben az üzenet a holtbetűvel lett elküldve. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                  |
| `DeliveryCount`                         | <p>Az üzenethez megkísérelt kézbesítések száma. A számláló akkor növekszik, ha az üzenetzárolás lejár, vagy a fogadó explicit módon félbehagyja az üzenetet. Ez a tulajdonság csak olvasható.</p> <p>A kézbesítések száma nem növekszik a mögöttes AMQP-kapcsolat lezártakor.</p>                                                                                                                                                                                                                                                 |
| `EnqueuedSequenceNumber`                | Az automatikusan továbbküldött üzeneteknél ez a tulajdonság azt a sorszámot tükrözi, amely az eredeti beküldési ponton először hozzá lett rendelve az üzenethez. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                                                                                |
| `EnqueuedTimeUtc`                       | Az UTC-példány, amelyen az üzenet elfogadva lett, és az entitásban van tárolva. Ez az érték akkor használható mérvadó és semleges érkezési időjelzőként, ha a fogadó nem szeretne megbízni a küldő órájában. Ez a tulajdonság csak olvasható.                                                                                                                                                                                                   |
| `ExpiresAtUtc` (abszolút lejárati idő) | Az UTC-példány, amelyen az üzenet eltávolításra van megjelölve, és lejárata miatt már nem érhető el az entitásból való lekéréshez. A lejáratot a **TimeToLive** tulajdonság vezérli, és ez a tulajdonság az EnqueuedTimeUtc+TimeToLive tulajdonságból van kiszámítva. Ez a tulajdonság csak olvasható.                                                                                                                                                                           |
| `Label` vagy `Subject` (tárgy)                       | Ez a tulajdonság lehetővé teszi, hogy az alkalmazás szabványos módon jelezze az üzenet célját a címzettnek, hasonlóan az e-mail tárgysorához.                                                                                                                                                                                                                                                                                  |
| `LockedUntilUtc`                        | A zárolással lekért üzenetek (betekintés-zárolás fogadási mód, nem előre meghatározott) esetén ez a tulajdonság azt az UTC-időt tükrözi, amely előtt az üzenet zárolva van az üzenetsorban/előfizetésben. Amikor a zárolás lejár, [a DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) növekszik, és az üzenet ismét elérhető lesz lekérésre. Ez a tulajdonság csak olvasható.                                                                                                                         |
| `LockToken`                             | A zárolási jogkivonat a közvetítő által betekintő fogadási módban lévő *zárolásra* hivatkozik. A jogkivonattal véglegesen rögzítheti a zárolást a [Deferral](message-deferral.md) API-n keresztül, és ezzel kiveheti az üzenetet a normál kézbesítési állapotból. Ez a tulajdonság csak olvasható.                                                                                                                                                               |
| `MessageId` (message-id)                | Az üzenetazonosító egy alkalmazás által meghatározott érték, amely egyedileg azonosítja az üzenetet és annak hasznos adatát. Az azonosító egy szabad formában megadott sztring, amely az alkalmazáskörnyezetből származtatott GUID-azonosítót vagy azonosítót is tükrözhet. Ha engedélyezve van, [a](duplicate-detection.md) duplikált üzenetek észlelése funkció azonosítja és eltávolítja a második és újabb üzeneteket ugyanazokkal a **MessageId azonosítóval.**                                                                |
| `PartitionKey`                          | [Particionált entitások esetén](service-bus-partitioning.md)ez az érték lehetővé teszi kapcsolódó üzenetek hozzárendelését ugyanathoz a belső partícióhoz, hogy a beküldési sorrend megfelelően rögzítve legyen. A partíciót egy kivonatf függvény választja ki ezen érték alapján, és nem választhatja ki közvetlenül. Munkamenet- értékű entitások esetében a **SessionId** tulajdonság felülírja ezt az értéket.                                                                                                       |
| `ReplyTo` (válasz-válasz)                    | Ez a választható és alkalmazás által meghatározott érték szabványos módszer az üzenet fogadója felé küldött válaszútvonal kifejezésre. Amikor a küldő választ vár, az értéket annak az üzenetsornak vagy témakörnek az abszolút vagy relatív elérési útjára állítja, amelybe a választ várják.                                                                                                                                           |
| `ReplyToSessionId` (válasz-csoport-azonosító)  | Ez az érték kiegészíti a **ReplyTo** adatait, és meghatározza, hogy a válaszentitásnak küldött válaszhoz melyik **SessionId** legyen beállítva.                                                                                                                                                                                                                                                                            |
| `ScheduledEnqueueTimeUtc`               | Olyan üzenetek esetén, amelyeket csak késve lehet lekérésre elérhetővé tenni, ez a tulajdonság határozza meg azt az UTC-azonnali időt, amelyen az üzenet logikailag össze lesz állítva, sorrendbe lesz állítva, és így lekérésre lesz elérhető.                                                                                                                                                                                                                 |
| `SequenceNumber`                        | A sorszám egy üzenethez rendelt egyedi 64 bites egész szám, amelyet a közvetítő elfogad és tárol, és valódi azonosítóként működik. Particionált entitások esetében a legfelső 16 bit a partícióazonosítót tükrözi. A szekvenciaszámok monoton módon növekednek, és nincsenek hézagok. A 48–64 bites tartomány kimerülve áttűnnek 0-ra. Ez a tulajdonság csak olvasható.                                                                |
| `SessionId` (csoportazonosító)                  | Ez az alkalmazás által definiált érték határozza meg az üzenet munkamenet-kapcsolatát a munkamenet-aware entitások esetében. Az azonos munkamenet-azonosítóval tartozó üzenetek összegzési zárolásnak vannak kitéve, és lehetővé teszik a pontos sorrendben történő feldolgozást és demultiplexinget. A munkamenet-figyelmét nem ható entitások esetében ez az érték figyelmen kívül lesz hagyva.                                                                                                                                     |
                                                                                                                                          |
| `TimeToLive`                            | Ez az érték az az időtartam, amely után az üzenet lejár, attól a pillanattól kezdve, amikor a közvetítő elfogadta és tárolta az üzenetet, az **EnqueueTimeUtc alatt rögzítettek szerint.** Ha nincs explicit módon beállítva, a feltételezett érték a **DefaultTimeToLive** lesz a megfelelő üzenetsorhoz vagy témakörhez. Az üzenetszintű **TimeToLive** érték nem lehet hosszabb, mint az entitás **DefaultTimeToLive beállítása.** Ha hosszabb, csendesen lesz módosítva. |
| `To` (to)                               | Ez a tulajdonság az útválasztási forgatókönyvekben való későbbi használatra van fenntartva, és jelenleg maga a közvetítő hagyja figyelmen kívül. Az alkalmazások ezt az értéket szabályalapú automatikus láncolási forgatókönyvekben is felhasználhatjak az üzenet kívánt logikai célhelyének jelzésére.                                                                                                                                                                                   |
| `ViaPartitionKey`                       | Ha egy üzenet egy tranzakció hatókörében lévő átviteli üzenetsoron keresztül van elküldve, ez az érték választja ki az átvitelisor-partíciót.                                                                                                                                                                                                                                                                                                                 |

Az absztrakt üzenetmodell lehetővé teszi egy üzenet üzenetsorba való elküldét HTTPS-en keresztül, és az AMQP-n keresztül lekérhető. Az üzenet mindkét esetben normálisnak tűnik a megfelelő protokoll kontextusában. A közvetítő tulajdonságai szükség szerint le vannak fordítva, és a felhasználói tulajdonságok a megfelelő protokoll üzenetmodellen a legmegfelelőbb helyre vannak leképezve. A HTTP-ban a felhasználói tulajdonságok közvetlenül a HTTP-fejlécek és -fejlécek között vannak leképezve; az AMQP-ben leképezik az alkalmazástulajdonságok **térképét.**

## <a name="message-routing-and-correlation"></a>Üzenetek útválasztása és korrelációja

A közvetítőtulajdonságok korábban ismertetett részkészlete, pontosabban a , , , , és a segítségével az alkalmazások adott célhelyre irányítják az `To` `ReplyTo` `ReplyToSessionId` `MessageId` `CorrelationId` `SessionId` üzeneteket. A funkció szemléltetésére venünk néhány mintát:

- **Egyszerű kérés/válasz:** A közzétevő üzenetet küld egy üzenetsorba, és választ vár az üzenet fogyasztójatól. A válasz fogadásához a közzétevőnek van egy üzenetsora, amelybe a válaszok kézbesítését várja. Az üzenetsor címe a kimenő üzenet **ReplyTo** tulajdonságában van kifejezve. Amikor a fogyasztó válaszol, átmásolja a kezelt üzenet **MessageId-ját** a válaszüzenet **CorrelationId** tulajdonságába, és kézbesíti az üzenetet a **ReplyTo** tulajdonság által jelzett célhelyre. Egy üzenet az alkalmazás környezetétől függően több választ is kaphat.
- **Csoportos küldési kérelem/válasz:** Az előző minta egy változataként a közzétevő elküldi az üzenetet egy témakörbe, és több feliratkozó jogosulttá válik az üzenetre. Minden előfizető a korábban ismertetett módon válaszolhat. Ezt a mintát felderítési vagy hívásváltási forgatókönyvekben használják, és a válaszadó általában egy felhasználói tulajdonsággal azonosítja magát, vagy a hasznos adatok között. Ha **a ReplyTo** egy témakörre mutat, akkor a felderítésre adott válaszok halmaza terjeszthető a célközönség számára.
- **Multiplexing**: Ez a munkamenet-funkció lehetővé teszi a kapcsolódó üzenetek streamjének multiplexelését egyetlen üzenetsoron vagy előfizetésen keresztül úgy, hogy a kapcsolódó üzenetek minden egyes munkamenete (vagy csoportja) egyező **SessionId-értékek** alapján legyen egy adott fogadóhoz irányítva, amíg a fogadó zárolás alatt tartja a munkamenetet. A munkamenetek részleteiről itt talál [további információt.](message-sessions.md)
- **Multiplexált kérés/válasz:** Ez a munkamenet-funkció lehetővé teszi a multiplexált válaszok megosztását, így több közzétevő osztozhat a válaszüzenetsoron. A **ReplyToSessionId** beállításával a közzétevő utasíthatja a fogyasztó(k)t, hogy másolja ezt az értéket a válaszüzenet **SessionId** tulajdonságába. A közzétételi üzenetsornak vagy témakörnek nem kell munkamenet- tisztában lennie. Az üzenet küldésekor a közzétevő egy munkamenet-fogadó feltételes elfogadásával kifejezetten megvárhatja, amíg az adott **SessionId-munkamenet** materializálva lesz az üzenetsorban. 

Az útválasztás egy Service Bus belül automatikus láncolás és témakör-előfizetési szabályok használatával valósulhat meg. A névterek közötti útválasztás az [Azure LogicApps használatával valósulhat meg.](https://azure.microsoft.com/services/logic-apps/) Ahogy az előző listában is látható, a **Cél** tulajdonság jövőbeli használatra van fenntartva, és a közvetítő egy speciálisan engedélyezett funkcióval értelmezheti. Az útválasztást implementni kívánó alkalmazásoknak ezt a felhasználói tulajdonságok alapján kell megtennie, és nem a **To tulajdonságra kell támaszkodnia;** ez azonban nem okoz kompatibilitási problémákat.

## <a name="payload-serialization"></a>Hasznos tartalom szerializálása

Átvitel közben vagy a tárolóban Service Bus hasznos adat mindig átlátszatlan bináris blokk. A tulajdonság lehetővé teszi, hogy az alkalmazások leírják a hasznos adatokat, a tulajdonságértékek javasolt formátuma pedig az `ContentType` IETF RFC2045 szerinti MIME-tartalomtípus-leírás, `application/json;charset=utf-8` például: .

A Java vagy a .NET Standard változatokkal ellentétben a Service Bus API .NET-keretrendszer-verziója támogatja **a BrokeredMessage-példányok** létrehozását tetszőleges .NET-objektumok a konstruktorba való átadása által. 

Az örökölt SBMP protokoll használata esetén ezek az objektumok az alapértelmezett bináris szerializálóval vagy külsőleg megadott szerializálóval vannak szerializálva. Az AMQP protokoll használata esetén az objektum EGY AMQP-objektumba lesz szerializálva. A fogadó a [GetBody \<T> ()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) metódussal lekérheti ezeket az objektumokat, és a várt típust adja meg. Az AMQP-ben az objektumok és objektumok AMQP-grafikonján vannak szerializálva, és bármely `ArrayList` `IDictionary<string,object>` AMQP-ügyfél dekódolhatja őket. 

Bár ez a rejtett szerializálási funkció kényelmes, az alkalmazásoknak explicit vezérlést kell adnunk az objektumok szerializálása felett, és adatfolyamokként kell az objektumgrafikonokat streamekbe kapcsolni, mielőtt üzeneteket hozunk létre, és a fogadóoldalon fordítva kell őket megtenni. Ez együttműködésre használható eredményeket ad. Bár az AMQP hatékony bináris kódolási modellel rendelkezik, az AMQP üzenetkezelési ökoszisztémához kötődik, és a HTTP-ügyfelek nehezen dekódolják az ilyen hasznos adatokat. 

A .NET Standard és a Java API változatok csak bájttömböt fogadnak el, ami azt jelenti, hogy az alkalmazásnak kell kezelnie az objektumszerializálási vezérlőt. 

## <a name="next-steps"></a>Következő lépések

Az üzenetkezelésről Service Bus alábbi témakörökben olvashat bővebben:

* [Service Bus queues, topics, and subscriptions (Service Bus-üzenetsorok, -témakörök és -előfizetések)](service-bus-queues-topics-subscriptions.md)
* [Bevezetés a Service Bus által kezelt üzenetsorok használatába](service-bus-dotnet-get-started-with-queues.md)
* [A Service Bus-üzenettémakörök és -előfizetések használata](service-bus-dotnet-how-to-use-topics-subscriptions.md)
