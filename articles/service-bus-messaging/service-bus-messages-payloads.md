---
title: Azure Service Bus-üzenetek, rakományok és szerializálás | Microsoft dokumentumok
description: Ez a cikk áttekintést nyújt az Azure Service Bus-üzenetekről, a rakományokról, az üzenet-útválasztásról és a szerializálásról.
services: service-bus-messaging
documentationcenter: ''
author: axisc
manager: timlt
editor: spelluru
ms.service: service-bus-messaging
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2020
ms.author: aschhab
ms.openlocfilehash: 11e56ae2483a254fb00e3593da7841f3f3d844f3
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76759397"
---
# <a name="messages-payloads-and-serialization"></a>Üzenetek, hasznos adatforgalom és szerializáció

A Microsoft Azure Service Bus kezeli az üzeneteket. Az üzenetek kulcsérték-pár tulajdonságok formájában tartalmaznak hasznos és metaadatokat, amelyek leírják a hasznos terhet, és kezelési utasításokat adnak a Service Busnak és az alkalmazásoknak. Esetenként, hogy a metaadatok önmagában elegendő ahhoz, hogy az információt, hogy a feladó azt akarja, hogy tájékoztassa a fogadók, és a hasznos teher üres marad.

A hivatalos Service Bus-ügyfelek objektummodellje .
 
A Service Bus-üzenet egy bináris tartalomszakaszból áll, amelyet a Service Bus soha nem kezel a szolgáltatásoldalon semmilyen formában, és két tulajdonságkészletet. A *bróker tulajdonságait* a rendszer előre meghatározza. Ezek az előre definiált tulajdonságok vagy vezérelik az üzenetszintű funkciókat a brókeren belül, vagy leképezik a közös és szabványosított metaadat-elemeket. A *felhasználói tulajdonságok* kulcs-érték párok gyűjteménye, amelyet az alkalmazás definiálhat és beállíthat.
 
Az előre definiált brókertulajdonságok az alábbi táblázatban találhatók. A nevek az összes hivatalos ügyfél API-val, valamint a HTTP protokollleképezés [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) JSON objektumában is használatosak.
 
Az AMQP protokoll szintjén használt egyenértékű nevek zárójelben vannak felsorolva. 

| Tulajdonság neve                         | Leírás                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (tartalomtípus)           | Opcionálisan leírja az üzenet hasznos terhelését, az RFC2045 5. például `application/json`.                                                                                                                                                                                                                                                                                             |
|  [Korrelációs azonosító](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (korrelációs azonosító)       | Lehetővé teszi, hogy egy alkalmazás korreláció céljából megadjon egy környezetet az üzenethez; például egy megválaszolt üzenet **MessageId** azonosítóját tükrözve.                                                                                                                                                                                                                                                                  |
| [DeadLetterForrás](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Csak olyan üzenetekben van beállítva, amelyek et kézbesítetlen levelek, majd automatikusan továbbítanak a kézbesítetlen levelek várólistájából egy másik entitásnak. Azt az entitást jelzi, amelyben az üzenet kézbesített. Ez a tulajdonság írásvédett.                                                                                                                                                                                                                                  |
| [DeliveryCount (Kézbesítési szám)](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | Az üzenethez megkísérelt kézbesítések száma. A számláló növekszik, ha egy üzenet zárolása lejár, vagy az üzenetet a fogadó kifejezetten elhagyta. Ez a tulajdonság írásvédett.                                                                                                                                                                                                                                                  |
| [EnqueuedSequenceNumber](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | Az automatikusan továbbított üzenetek esetében ez a tulajdonság azt a sorszámot tükrözi, amelyet először az eredeti beküldési ponton rendeltek hozzá az üzenethez. Ez a tulajdonság írásvédett.                                                                                                                                                                                                                                                                |
| [VárólistánTimeUtc](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | Az az UTC-pillanat, amikor az üzenetet elfogadták és az entitásban tárolták. Ez az érték mérvadó és semleges érkezési idő jelzőjeként használható, ha a fogadó nem akar megbízni a feladó órájában. Ez a tulajdonság írásvédett.                                                                                                                                                                                                   |
|  [ExpiresAtUtc](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (abszolút lejárati idő) | Az UTC-pillanat, amelyen az üzenet eltávolításra van megjelölve, és amely a lejárata miatt már nem érhető el az entitásból való lekéréshez. A lejárati időt a **TimeToLive** tulajdonság szabályozza, és ezt a tulajdonságot az EnqueuedTimeUtc+TimeToLive számításai alapján számítjuk ki. Ez a tulajdonság írásvédett.                                                                                                                                                                           |
| [ForcePersistence (Kényszerítéspersistence)](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Az [EnableExpress](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) jelzővel beállított várólisták vagy témakörök esetében ez a tulajdonság beállítható úgy, hogy jelezze, hogy az üzenetet a nyugtázás előtt meg kell tartani a lemezen. Ez az összes nem expressz entitás szokásos viselkedése.                                                                                                                                                                                                         |
| [Címke](/dotnet/api/microsoft.azure.servicebus.message.label) (tárgy)                       | Ez a tulajdonság lehetővé teszi, hogy az alkalmazás szabványos módon jelezze az üzenet célját a címzettnek, hasonlóan az e-mail tárgysorához.                                                                                                                                                                                                                                                                                  |
| [ZárolvaUtcig](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | A zárolás alatt beolvasott üzenetek (betekintés-zárolás fogadási mód, nem előre kiegyenlített) esetén ez a tulajdonság az UTC-azonnali tantárgyat tükrözi, amíg az üzenet a várólistában/előfizetésben van elzárva. Amikor a zárolás lejár, a [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) növekszik, és az üzenet ismét lekérésre érhető el. Ez a tulajdonság írásvédett.                                                                                                                         |
| [LockToken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | A zárolási jogkivonat a bróker által *kukucszárolási módban* tartott zárolásra mutató hivatkozás. A jogkivonat segítségével véglegesen rögzítheti a zárolást a [halasztási](message-deferral.md) API-n keresztül, és ezzel kiveheti az üzenetet a normál kézbesítési állapot folyamatából. Ez a tulajdonság írásvédett.                                                                                                                                                               |
| [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid) (üzenetazonosító)                | Az üzenetazonosító egy alkalmazás által definiált érték, amely egyedileg azonosítja az üzenetet és annak hasznos adatát. Az azonosító egy szabad formátumú karakterlánc, amely az alkalmazáskörnyezetből származó GUID azonosítót vagy azonosítót tükrözhet. Ha engedélyezve van, a [duplikáltelem-észlelési](duplicate-detection.md) szolgáltatás azonosítja és eltávolítja az azonos **MessageId**azonosítóval rendelkező üzenetek második és további beküldését.                                                                |
| [PartitionKey](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | [Particionált entitások](service-bus-partitioning.md)esetén az érték beállítása lehetővé teszi a kapcsolódó üzenetek hozzárendelését ugyanahhoz a belső partícióhoz, így a küldési sorrend megfelelő rögzítése. A partíciót egy kivonatoló függvény választja ki ezen az értéken, és közvetlenül nem választható ki. Munkamenet-barát entitások esetén a **SessionId** tulajdonság felülbírálja ezt az értéket.                                                                                                       |
| [Válasz:Válasz–válasz(reply-to)](/dotnet/api/microsoft.azure.servicebus.message.replyto)                    | Ez az opcionális és az alkalmazás által definiált érték az üzenet fogadójának adott válaszelérési út kifejezésének szabványos módja. Amikor a feladó választ vár, az értéket annak a várólistavagy témakör abszolút vagy relatív elérési útjára állítja be, amelyre a választ el szeretné küldeni.                                                                                                                                           |
| [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (válasz-csoport-id)  | Ez az érték növeli a **ReplyTo** információt, és meghatározza, hogy melyik **SessionId** kell beállítani a választ, amikor elküldi a válasz entitás.                                                                                                                                                                                                                                                                            |
| [ÜtemezettEnqueueTimeUtc](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | A csak késleltetés után visszakereshető üzenetek esetében ez a tulajdonság határozza meg azt az UTC-azonnalit, ahol az üzenet logikailag várólistára kerül, szekvenálva lesz, és ezért lekérésre elérhetővé válik.                                                                                                                                                                                                                 |
| [SequenceNumber (SequenceNumber)](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | A sorszám egy egyedi 64 bites egész szám, amelyet egy üzenethez rendelnek, mivel azt a bróker elfogadja és tárolja, és valódi azonosítóként működik. Particionált entitások esetén a legfelső 16 bit a partícióazonosítót tükrözi. A sorozatszámok monoton módon növekednek és hézagmentesek. 0-ra fordulnak, ha a 48-64 bittartomány kimerül. Ez a tulajdonság írásvédett.                                                                |
| [Munkamenet-azonosító](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (csoportazonosító)                  | Munkamenet-barát entitások esetén ez az alkalmazás által definiált érték határozza meg az üzenet munkamenet-kapcsolatát. Az azonos munkamenet-azonosítóval rendelkező üzenetek összefoglaló zárolást tesznek lehetővé, és lehetővé teszik a pontos sorrendi feldolgozást és demultiplexelést. A nem munkamenet-tisztában lévő entitások esetében ezt az értéket a rendszer figyelmen kívül hagyja.                                                                                                                                     |
| [Méret](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | A közvetítői naplóban tárolt üzenet méretét tükrözi bájtok számaként, mivel beleszámít a tárolási kvótába. Ez a tulajdonság írásvédett.                                                                                                                                                                                                                                                                                                       |
| [Állapot](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Az üzenet állapotát jelzi a naplóban. Ez a tulajdonság csak az üzenetböngészés során ("betekintés") releváns annak meghatározásához, hogy egy üzenet "aktív"-e és elérhető-e a várólista tetejére, hogy elhalasztva van-e, vagy ütemezésre vár.This property is only relevant during message browsing ("peek"), to determine whether an message is "active" and available for retrieving as it reaches the top of the queue, whether it is eferred, or is waiting to be scheduled. Ez a tulajdonság írásvédett.                                                                                                                                           |
| [TimeToLive](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Ez az érték az a relatív időtartam, amely után az üzenet lejár, kezdve attól a pillanattól kezdve, hogy az üzenetet a bróker elfogadta és tárolta, az **EnqueueTimeUtc**alkalmazásban rögzített módon. Ha nincs beállítva explicit módon, a feltételezett érték a **DefaultTimeToLive** az adott várólista vagy témakör. Az üzenetszintű **TimeToLive** érték nem lehet hosszabb, mint az entitás **DefaultTimeToLive** beállítása. Ha hosszabb, akkor csendben be van állítva. |
| [A(z)](/dotnet/api/microsoft.azure.servicebus.message.to) (a)                               | Ez a tulajdonság az útválasztási forgatókönyvekben való jövőbeli használatra van fenntartva, és jelenleg maga a közvetítő figyelmen kívül hagyja. Az alkalmazások ezt az értéket használhatják a szabályvezérelt automatikus továbbítási forgatókönyvekben az üzenet tervezett logikai céljának jelzésére.                                                                                                                                                                                   |
| [ViaPartitionKey](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Ha egy üzenetet egy tranzakció hatókörében lévő átviteli várólistán keresztül küld, ez az érték választja ki az átviteli várólista partícióját.                                                                                                                                                                                                                                                                                                                 |

Az absztrakt üzenetmodell lehetővé teszi, hogy egy üzenet HTTP-n keresztül (valójában mindig HTTPS) keresztül kerül-e várólistára, és az AMQP-n keresztül lehívható. Az üzenet mindkét esetben normálisnak tűnik az adott protokoll kontextusában. A közvetítő imázsa szükség szerint levan fordítva, és a felhasználói tulajdonságok a megfelelő protokollüzenet-modell legmegfelelőbb helyére vannak leképezve. A HTTP-ben a felhasználói tulajdonságok közvetlenül a HTTP-fejlécekhez és azokból vannak leképezve; az AMQP-ben az **alkalmazás-tulajdonságok** térképére és onnan.

## <a name="message-routing-and-correlation"></a>Üzenet-útválasztás és korreláció

A korábban leírt közvetítői tulajdonságok egy részhalmaza, különösen [a Címzett](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid)és [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid), segítségével az alkalmazások üzeneteket irányíthatnak bizonyos helyekre. [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto) Ennek szemléltetésére vegyünk néhány mintát:

- **Egyszerű kérés/válasz:** A közzétevő üzenetet küld egy várólistába, és választ vár az üzenetfogyasztótól. A válasz fogadásához a közzétevő rendelkezik egy várólistával, amelybe a válaszok kézbesítésére számít. A várólista címe a kimenő üzenet **ReplyTo** tulajdonságában van kifejezve. Amikor az fogyasztó válaszol, a kezelt üzenet **MessageId azonosítóját** átmásolja a válaszüzenet **CorrelationId** tulajdonságába, és kézbesíti az üzenetet a **ReplyTo** tulajdonság által megjelölt célhelyre. Egy üzenet az alkalmazás környezetétől függően több választ is adhat.
- **Csoportos küldési kérelem/válasz:** Az előző minta változataként a közzétevő elküldi az üzenetet egy témakörbe, és több előfizető jogosulttá válik az üzenet felhasználására. Az előfizetők mindegyike a korábban leírt módon válaszolhat. Ez a minta felderítési vagy név szerinti hívás forgatókönyvekben használatos, és a válaszadó általában azonosítja magát egy felhasználói tulajdonsággal vagy a hasznos adaton belül. Ha **a ReplyTo** egy témakörre mutat, a felderítési válaszok ilyen készlete eljuttatható a közönségnek.
- **Multiplexelés:** Ez a munkamenet-funkció lehetővé teszi a kapcsolódó üzenetek adatfolyamainak egyetlen várólistán vagy előfizetésen keresztültörténő multiplexelését, így a kapcsolódó üzenetek minden munkamenete (vagy csoportja), amelyet a **SessionId** értékek egyeznek, egy adott vevőhöz kerül, miközben a fogadó a munkamenetet zárolva tartja. Tudjon meg többet a részleteket ülések [itt](message-sessions.md).
- **Multiplexelt kérés/válasz:** Ez a munkamenet-funkció lehetővé teszi a multiplex válaszokat, lehetővé téve több közzétevő számára a válaszlista megosztását. A **ReplyToSessionId**beállításával a közzétevő utasíthatja az utas(oka)t, hogy másolja az értéket a válaszüzenet **SessionId** tulajdonságába. A közzétételi várólistának vagy témakörnek nem kell munkamenet-barátnak lennie. Az üzenet elküldésekor a közzétevő ezután kifejezetten megvárhatja, hogy az adott **Munkamenet-azonosítóval** rendelkező munkamenet a munkamenet-fogadó feltételes elfogadásával valósuljon meg a várólistán. 

A Service Bus-névtéren belüli útválasztás automatikus továbbítási láncolással és témakör-előfizetési szabályokkal valósítható meg. A névterek közötti útválasztás az [Azure LogicApps használatával](https://azure.microsoft.com/services/logic-apps/)valósítható meg. Amint azt az előző listában, a **To** tulajdonság van fenntartva a későbbi használatra, és végül lehet értelmezni a bróker egy speciálisan engedélyezett funkció. Az útválasztást megvalósítani kívánó alkalmazásoknak ezt a felhasználói tulajdonságok alapján kell megtenniük, és nem a To tulajdonságra kell **támaszkodniuk;** ha azonban most teszi, az nem okoz kompatibilitási problémákat.

## <a name="payload-serialization"></a>Hasznos tartalom szerializálása

A Service Bus-on keresztül vagy a Service Bus-on belül tárolva a hasznos adat mindig átlátszatlan, bináris blokk. A [ContentType](/dotnet/api/microsoft.azure.servicebus.message.contenttype) tulajdonság lehetővé teszi, hogy az alkalmazások leírják a hasznos tartalmat, és a tulajdonságértékek javasolt formátuma az IETF RFC2045 szerinti MIME-tartalomtípus leírása; például `application/json;charset=utf-8`.

A Java vagy a .NET Standard változatokkal ellentétben a Service **BrokeredMessage** Bus API . 

Az örökölt SBMP protokoll használatakor ezeket az objektumokat ezután szerializálják az alapértelmezett bináris szerializálóval, vagy egy külsőleg biztosított szerializálóval. Az AMQP protokoll használatakor az objektum egy AMQP-objektumba kerül. A vevő a [GetBody\<T>()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) metódussal lekérheti ezeket az objektumokat, megadhatja a várt típust. Az AMQP segítségével az objektumok szerializálódnak az **ArrayList** és **az IDictionary<karakterlánc, az objektum>** objektumok AMQP-diagramjába, és bármely AMQP-ügyfél dekódolhatja őket. 

Bár ez a rejtett szerializálási varázslat kényelmes, az alkalmazásoknak kifejezetten irányítaniuk kell az objektumszerializálást, és az objektumdiagramokat streamekké kell alakítaniuk, mielőtt üzenetbe vonnák őket, és a vevő oldalon fordítva. Ez interoperábilis eredményeket eredményez. Azt is meg kell jegyezni, hogy míg az AMQP egy hatékony bináris kódolási modell, ez kötődik az AMQP üzenetküldő ökoszisztéma és a HTTP-ügyfelek lesz baj dekódolás ilyen hasznos adatokat. 

Általában a JSON és az Apache Avro használatát javasoljuk a strukturált adatok hasznos adatformátumaként.

A .NET Standard és a Java API-változatok csak bájttömböket fogadnak el, ami azt jelenti, hogy az alkalmazásnak kezelnie kell az objektumszerializálási vezérlőt. 

## <a name="next-steps"></a>További lépések

Ha többet szeretne megtudni a Service Bus üzenetküldéséről, olvassa el az alábbi témaköröket:

* [Service Bus queues, topics, and subscriptions (Service Bus-üzenetsorok, -témakörök és -előfizetések)](service-bus-queues-topics-subscriptions.md)
* [Bevezetés a Service Bus által kezelt üzenetsorok használatába](service-bus-dotnet-get-started-with-queues.md)
* [A Service Bus-üzenettémakörök és -előfizetések használata](service-bus-dotnet-how-to-use-topics-subscriptions.md)
