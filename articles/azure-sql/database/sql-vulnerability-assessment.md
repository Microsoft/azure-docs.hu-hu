---
title: SQL-sebezhetőségi felmérés
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: Ismerje meg, hogyan konfigurálhatja az SQL sebezhetőségi felmérést, és hogyan értelmezheti a Azure SQL Database, az Azure SQL felügyelt példányának és az Azure szinapszis Analyticsnek az értékelési jelentéseket.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 09/21/2020
tags: azure-synapse
ms.openlocfilehash: 67258a19d1efe605a3a0b2227f107cc1928a207a
ms.sourcegitcommit: 8245325f9170371e08bbc66da7a6c292bbbd94cc
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 02/07/2021
ms.locfileid: "99806392"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Az SQL sebezhetőségi felmérés segítséget nyújt az adatbázis-sebezhetőségek azonosításában
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

Az SQL sebezhetőségi felmérés egy könnyen konfigurálható szolgáltatás, amely képes felderíteni, nyomon követni és segíteni a lehetséges adatbázis-sebezhetőségeket. A használatával proaktívan növelhető az adatbázis biztonsága.

A sebezhetőségi felmérés az [Azure Defender for SQL](azure-defender-for-sql.md) -ajánlat része, amely a fejlett SQL-biztonsági funkciók egységes csomagja. A sebezhetőségi felmérés a központi Azure Defender for SQL Portalon érhető el és kezelhető.

> [!NOTE]
> A sebezhetőségi felmérés a Azure SQL Database, az Azure SQL felügyelt példánya és az Azure szinapszis Analytics esetében támogatott. A Azure SQL Databaseban, az Azure SQL felügyelt példányában és az Azure szinapszis Analyticsben lévő adatbázisokat a cikk további részében adatbázisként hivatkoznak, és a kiszolgáló arra a [kiszolgálóra](logical-servers.md) hivatkozik, amely a Azure SQL Database és az Azure szinapszis adatbázisait tárolja.

## <a name="what-is-sql-vulnerability-assessment"></a>Mi az SQL sebezhetőségi felmérés?

Az SQL sebezhetőségi felmérés egy olyan szolgáltatás, amely láthatóságot biztosít a biztonsági állapotában. A biztonsági rések felmérése a biztonsági problémák megoldásához és az adatbázis biztonságának javításához szükséges lépéseket tartalmazza. Segítséget nyújt a dinamikus adatbázis-környezet figyelésében, ahol a változások nehéz nyomon követni és javítani az SQL biztonsági helyzetét.

A sebezhetőségi felmérés egy Azure SQL Database beépített ellenőrzési szolgáltatás. A szolgáltatás a biztonsági réseket jelző szabályok tudásbázisát alkalmazza. Kiemeli az ajánlott eljárásoktól való eltéréseket, például a helytelen konfigurációkat, a túlzott engedélyeket és a nem védett bizalmas adatokat.

A szabályok a Microsoft ajánlott eljárásain alapulnak, és olyan biztonsági problémákra összpontosítanak, amelyek a legnagyobb kockázatokat jelentik az adatbázis és értékes adatai számára. Ezek kiterjednek az adatbázis-szintű problémákra és a kiszolgálói szintű biztonsági problémákra, például a kiszolgáló tűzfalának beállításaira és a kiszolgálói szintű engedélyekre.

A vizsgálat eredményei közé tartozik az egyes problémák megoldásához szükséges műveletek végrehajtása, valamint a testreszabott szervizelési parancsfájlok megadása, ha vannak ilyenek. A környezethez tartozó értékelési jelentéseket a következő elfogadható alapkonfiguráció beállításával szabhatja testre:

- Engedélyezési konfigurációk
- Szolgáltatások konfigurációi
- Adatbázis-beállítások

## <a name="configure-vulnerability-assessment"></a>Sebezhetőségi felmérés konfigurálása

A következő lépésekkel konfigurálhatja a sebezhetőségi felmérést:

1. Nyissa meg a Azure SQL Database, az SQL felügyelt példányának adatbázisát vagy az Azure szinapszis-erőforrást a [Azure Portal](https://portal.azure.com).

2. A **Biztonság** fejléc alatt válassza a **Security Center** lehetőséget.

3. Ezután kattintson a **configure (Konfigurálás** ) elemre a hivatkozáson az Azure DEFENDER for SQL beállítások panel megnyitásához a teljes kiszolgáló vagy a felügyelt példány számára.

    > [!NOTE]
    > Az SQL sebezhetőségi felmérés megköveteli, hogy az **Azure Defender az SQL** -csomag futtatásával képes legyen a vizsgálatok futtatására. Az Azure Defender for SQL engedélyezésével kapcsolatos további információkért lásd: [Az Azure Defender for SQL](azure-defender-for-sql.md).

4. Olyan Storage-fiók konfigurálása, amelyben a rendszer a kiszolgálón vagy a felügyelt példányon lévő összes adatbázisra vonatkozó vizsgálati eredményeket tárolja. További információ a Storage-fiókokról: [Tudnivalók az Azure Storage-fiókokról](../../storage/common/storage-account-create.md).

    > [!NOTE]
    > A biztonsági rések felmérésének a tűzfalak és a virtuális hálózatok mögötti vizsgálatával kapcsolatos további információkért lásd: [a sebezhetőségi felmérések vizsgálatának eredményeinek tárolása a tűzfalak és a virtuális hálózatok mögött elérhető Storage-fiókban](sql-database-vulnerability-assessment-storage.md).

5. Állítsa be az SQL sebezhetőségi felmérést úgy, hogy hetente egyszer automatikusan futtasson rendszeres időközönként ismétlődő vizsgálatokat, hogy észlelje a változási biztonsági beállítások automatikus módosítását. Ehhez engedélyezze az **időszakos ismétlődő vizsgálatokat** a Storage-fiók kiválasztása alatt. A rendszer elküldi a vizsgálati eredmények összegzését a **küldési jelentések küldése** a következőhöz megadott e-mail-címekre:. E-mailes értesítést is küldhet a rendszergazdáknak és az előfizetések tulajdonosainak, ha **e-mailben értesítést küld a rendszergazdáknak és az előfizetés tulajdonosainak**.

6. Az SQL sebezhetőségi felmérés igény szerint képes futtatni a vizsgálatot. Az SQL sebezhetőségi felmérés konfigurálása után válassza a **vizsgálat** lehetőséget az adatbázis biztonsági rések vizsgálatához.

![Adatbázis vizsgálata](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > A vizsgálat könnyű és biztonságos. A Futtatás néhány másodpercig tart, és a teljes egészében írásvédett. Nem végez semmilyen módosítást az adatbázisban.

## <a name="remediate-vulnerabilities"></a>Sebezhetőségek javítása

1. Ha a vizsgálat elkészült, a vizsgálati jelentés automatikusan megjelenik a Azure Portal. A jelentés áttekintést nyújt a biztonsági állapotáról. Azt is felsorolja, hogy hány problémát észlelt a rendszer, és hogy milyen problémák merültek fel. Az eredmények közé tartoznak az ajánlott eljárásoktól való eltérések, valamint a biztonsággal kapcsolatos beállítások pillanatképe, például az adatbázis-rendszerbiztonsági tag és a szerepkörök, valamint a hozzájuk tartozó engedélyek.

![A jelentés megtekintése](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

2. Tekintse át az eredményeket, és határozza meg a jelentés azon eredményeit, amelyek a környezetében igaz biztonsági problémák. Az egyes sikertelen eredmények részletezésével megismerheti a megállapítások hatását, és hogy miért nem sikerült az egyes biztonsági ellenőrzések végrehajtása. A probléma megoldásához használja a jelentés által biztosított végrehajtható szervizelési információkat.

![A jelentés elemzése](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

3. Az értékelés eredményeinek áttekintése során megadhatja, hogy az *eredmények a környezetében elfogadható* alapkonfigurációként legyenek megjelölve. Az alapterv alapvetően az eredmények jelentésének testreszabása. Az alapkonfigurációnak megfelelő eredmények a későbbi vizsgálatokban való továbbításnak tekintendők. Az alapkonfiguráció biztonsági állapotának megállapítása után a sebezhetőségi felmérés csak az alaptervtől való eltérésekről készít jelentést. Így a kapcsolódó problémákra koncentrálhat.

![Az Alapterv beállítása](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

4. Miután befejezte a **szabályok alaptervének** beállítását, egy új vizsgálat futtatásával tekintheti meg a testreszabott jelentést. A sebezhetőségi felmérés most csak azokat a biztonsági problémákat jelenti, amelyek eltérnek a jóváhagyott alapkonfigurációtól.

![Testreszabott jelentés megtekintése](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

A sebezhetőségi felmérés mostantól nyomon követhető, hogy az adatbázis folyamatosan magas szintű biztonságot tart fenn, és a szervezeti szabályzatok teljesülnek. 

## <a name="advanced-capabilities"></a>Speciális képességek

### <a name="export-an-assessment-report"></a>Értékelési jelentés exportálása

Válassza a **vizsgálati eredmények exportálása** lehetőséget a vizsgálati eredmény letölthető Excel-jelentésének létrehozásához. Ez a jelentés egy Összegzés fület tartalmaz, amely az értékelés összegzését jeleníti meg. A jelentés tartalmazza az összes sikertelen ellenőrzést. Emellett tartalmaz egy **Results (eredmények** ) lapot is, amely az eredmények teljes készletét tartalmazza a vizsgálatból. Az eredmények tartalmazzák az összes futtatott ellenőrzést, valamint az eredmény részleteit.

### <a name="view-scan-history"></a>Vizsgálati előzmények megtekintése

A biztonsági rések felmérése ablaktáblán válassza a **vizsgálat előzményei** lehetőséget, hogy megtekintse az adatbázison korábban futtatott összes vizsgálat előzményeit. Válasszon ki egy adott vizsgálatot a listában a vizsgálat részletes eredményeinek megtekintéséhez.

## <a name="manage-vulnerability-assessments-programmatically"></a>A sebezhetőségi felmérések programozott kezelése

### <a name="using-azure-powershell"></a>Az Azure PowerShell használata

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> A PowerShell Azure Resource Manager modul továbbra is támogatott, de a jövőbeli fejlesztés az az. SQL modulhoz készült. Ezekhez a parancsmagokhoz lásd: [AzureRM. SQL](/powershell/module/AzureRM.Sql/). Az az modul és a AzureRm modulok parancsainak argumentumai lényegében azonosak.

Azure PowerShell parancsmagokkal programozott módon kezelheti a sebezhetőségi felméréseket. A támogatott parancsmagok a következők:

| Parancsmag neve hivatkozásként | Description |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Törli a sebezhetőségi felmérési szabály alaptervét.<br/>Először állítsa be az alaptervet, mielőtt ezt a parancsmagot használja a törléshez. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Törli egy adatbázis sebezhetőség-felmérési beállításait. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Törli a felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét.<br/>Először állítsa be az alaptervet, mielőtt ezt a parancsmagot használja a törléshez. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Törli a felügyelt adatbázis sebezhetőségi felmérésének beállításait. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Törli a felügyelt példány sebezhetőségi felmérésének beállításait. |
| [Átalakítás – AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Átalakítja a sebezhetőségi felmérés eredményeit egy adatbázis egy Excel-fájlba. |
| [Átalakítás – AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | A felügyelt adatbázisok sebezhetőségi felmérésének eredményét egy Excel-fájlba alakítja át. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Beolvassa egy adatbázis sebezhetőségi felmérési szabályának alaptervét egy adott szabályhoz. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Lekéri egy adott szabályhoz tartozó felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Az adott adatbázishoz tartozó összes sebezhetőségi felmérési vizsgálati rekord beolvasása. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Beolvassa az adott felügyelt adatbázishoz tartozó összes sebezhetőségi felmérési vizsgálati rekordot. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Egy adatbázis sebezhetőség-értékelési beállításait adja vissza. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Egy felügyelt adatbázis sebezhetőségi felmérési beállításait adja vissza. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Beállítja a sebezhetőségi felmérési szabály alaptervét. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Beállítja egy felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét. |
| [Start – AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Elindítja a sebezhetőségi felmérések vizsgálatának kezdetét egy adatbázison. |
| [Start – AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Egy felügyelt adatbázison elindítja a sebezhetőségi felmérések vizsgálatának kezdetét. |
| [Frissítés – AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Frissíti egy adatbázis sebezhetőség-felmérési beállításait. |
| [Frissítés – AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Frissíti egy felügyelt adatbázis sebezhetőségi felmérési beállításait. |
| [Frissítés – AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Frissíti egy felügyelt példány sebezhetőségi felmérésének beállításait. |
| &nbsp; | &nbsp; |

A parancsfájl-példákat lásd: az [Azure SQL sebezhetőségi felmérés PowerShell-támogatása](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support).

### <a name="using-resource-manager-templates"></a>Resource Manager-sablonok használata

A sebezhetőségi felmérés alapkonfigurációinak Azure Resource Manager sablonok használatával történő konfigurálásához használja a `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` típust.

Győződjön meg arról, hogy az `vulnerabilityAssessments` alaptervek hozzáadása előtt engedélyezte a használatát.

Az alábbi példa egy `master` `user` Resource Manager-sablonban lévő erőforrásokként az adatbázis-és a VA1143-VA2065 alapkonfiguráció-szabály definiálását szemlélteti:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

`master`Az adatbázis és `user` az adatbázis esetében az erőforrások nevei eltérően vannak definiálva:

- Master Database – "Name": "[Összefűzés (parameters (' server_name '), '/', parameters (' database_name '), '/default/VA2065/<b>Master</b>')]
- Felhasználói adatbázis – "név": "[Összefűzés (parameters (' server_name '), '/', parameters (' database_name '), '/default/VA2065/<b>default</b>')]",

A logikai típusok igaz/hamis értékre való kezeléséhez állítsa az alapkonfiguráció eredményét bináris bemenetként, például: "1"/"0".

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Következő lépések  

- További információ [Az Azure Defender for SQL szolgáltatásról](azure-defender-for-sql.md).
- További információ az [adatfelderítésről és a besorolásról](data-discovery-and-classification-overview.md).
- További információ a [sebezhetőségi felmérések vizsgálatának eredményeiről a tűzfalak és a virtuális hálózatok mögött elérhető Storage-fiókban](sql-database-vulnerability-assessment-storage.md).
