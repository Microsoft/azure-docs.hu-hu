---
title: SQL sebezhetőségi felmérés
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: Ismerje meg, hogyan konfigurálhatja az SQL sebezhetőségi felmérést, és hogyan értelmezheti a Azure SQL Database, az Azure SQL felügyelt példányának és az Azure szinapszis Analyticsnek az értékelési jelentéseket.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 02/11/2021
tags: azure-synapse
ms.openlocfilehash: 1719c5a7112ee32f86d0593d274a59638cf81a0e
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100376620"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Az SQL sebezhetőségi felmérés segítséget nyújt az adatbázis-sebezhetőségek azonosításában
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

Az SQL sebezhetőségi felmérés egy könnyen konfigurálható szolgáltatás, amely képes felderíteni, nyomon követni és segíteni a lehetséges adatbázis-sebezhetőségeket. A használatával proaktívan növelhető az adatbázis biztonsága.

A sebezhetőségi felmérés az [Azure Defender for SQL](azure-defender-for-sql.md) -ajánlat része, amely a fejlett SQL-biztonsági funkciók egységes csomagja. A sebezhetőségi felmérés a központi Azure Defender for SQL Portalon érhető el és kezelhető.

> [!NOTE]
> A sebezhetőségi felmérés a Azure SQL Database, az Azure SQL felügyelt példánya és az Azure szinapszis Analytics esetében támogatott. A Azure SQL Databaseban, az Azure SQL felügyelt példányában és az Azure szinapszis Analyticsben lévő adatbázisokat a cikk további részében adatbázisként hivatkoznak, és a kiszolgáló arra a [kiszolgálóra](logical-servers.md) hivatkozik, amely a Azure SQL Database és az Azure szinapszis adatbázisait tárolja.

## <a name="what-is-sql-vulnerability-assessment"></a>Mi az SQL sebezhetőségi felmérés?

Az SQL sebezhetőségi felmérés egy olyan szolgáltatás, amely láthatóságot biztosít a biztonsági állapotában. A biztonsági rések felmérése a biztonsági problémák megoldásához és az adatbázis biztonságának javításához szükséges lépéseket tartalmazza. Segítséget nyújt a dinamikus adatbázis-környezet figyelésében, ahol a változások nehéz nyomon követni és javítani az SQL biztonsági helyzetét.

A sebezhetőségi felmérés egy Azure SQL Database beépített ellenőrzési szolgáltatás. A szolgáltatás a biztonsági réseket jelző szabályok tudásbázisát alkalmazza. Kiemeli az ajánlott eljárásoktól való eltéréseket, például a helytelen konfigurációkat, a túlzott engedélyeket és a nem védett bizalmas adatokat.

A szabályok a Microsoft ajánlott eljárásain alapulnak, és olyan biztonsági problémákra összpontosítanak, amelyek a legnagyobb kockázatokat jelentik az adatbázis és értékes adatai számára. Ezek kiterjednek az adatbázis-szintű problémákra és a kiszolgálói szintű biztonsági problémákra, például a kiszolgáló tűzfalának beállításaira és a kiszolgálói szintű engedélyekre.

A vizsgálat eredményei közé tartozik az egyes problémák megoldásához szükséges műveletek végrehajtása, valamint a testreszabott szervizelési parancsfájlok megadása, ha vannak ilyenek. A környezethez tartozó értékelési jelentéseket a következő elfogadható alapkonfiguráció beállításával szabhatja testre:

- Engedélyezési konfigurációk
- Szolgáltatások konfigurációi
- Adatbázis-beállítások

## <a name="configure-vulnerability-assessment"></a>Sebezhetőségi felmérés konfigurálása

A sebezhetőségi felmérés konfigurálásához hajtsa végre a következő lépéseket:

1. A [Azure Portal](https://portal.azure.com)nyissa meg az adott erőforrást Azure SQL Database, SQL felügyelt példány-adatbázisban vagy az Azure szinapszisban.

1. A **Biztonság** fejléc alatt válassza a **Security Center** lehetőséget.

1. Válassza a **Konfigurálás** lehetőséget a hivatkozáson az Azure DEFENDER for SQL-beállítások panel megnyitásához a teljes kiszolgáló vagy a felügyelt példány számára.

    :::image type="content" source="media/sql-vulnerability-assessment/opening-sql-configuration.png" alt-text="A Defender for SQL-konfiguráció megnyitása":::

    > [!NOTE]
    > Az SQL sebezhetőségi felmérés megköveteli, hogy az **Azure Defender az SQL** -csomag futtatásával képes legyen a vizsgálatok futtatására. Az Azure Defender for SQL engedélyezésével kapcsolatos további információkért lásd: [Az Azure Defender for SQL](azure-defender-for-sql.md).

1. A **kiszolgáló beállításai** lapon adja meg az SQL-alapú Azure Defender-beállításokat:

    :::image type="content" source="media/sql-vulnerability-assessment/sql-vulnerability-scan-settings.png" alt-text="Az SQL sebezhetőségi felmérések vizsgálatának konfigurálása":::

    1. Olyan Storage-fiók konfigurálása, amelyben a rendszer a kiszolgálón vagy a felügyelt példányon lévő összes adatbázisra vonatkozó vizsgálati eredményeket tárolja. További információ a Storage-fiókokról: [Tudnivalók az Azure Storage-fiókokról](../../storage/common/storage-account-create.md).

        > [!TIP]
        > A biztonsági rések felmérésének a tűzfalak és a virtuális hálózatok mögötti vizsgálatával kapcsolatos további információkért lásd: [a sebezhetőségi felmérések vizsgálatának eredményeinek tárolása a tűzfalak és a virtuális hálózatok mögött elérhető Storage-fiókban](sql-database-vulnerability-assessment-storage.md).

    1. Ha úgy konfigurálja a sebezhetőségi felméréseket, hogy automatikusan futtasson hetente végzett vizsgálatokat a biztonsági hibás konfigurációk észlelése érdekében, állítsa be a **rendszeres ismétlődő vizsgálatokat** **a** be értékre. Az eredményeket a rendszer elküldi az e-mail-címekre, amelyeket a **vizsgálati jelentések küldése** a következőhöz megadott:. E-mailes értesítést is küldhet a rendszergazdáknak és az előfizetések tulajdonosainak, ha **e-mailben értesítést küld a rendszergazdáknak és az előfizetés tulajdonosainak**.

1. Az SQL sebezhetőségi felmérések vizsgálata is igény szerint futtatható:

    1. Az erőforrás **Security Center** lapján válassza a **további megállapítások megtekintése a sebezhetőségi felmérésben** lehetőséget a korábbi vizsgálatok vizsgálati eredményeinek eléréséhez.

        :::image type="content" source="media/sql-vulnerability-assessment/view-additional-findings-link.png" alt-text="A vizsgálati eredmények és a manuális vizsgálati beállítások megnyitása":::

    1. Ha igény szerinti vizsgálatot szeretne futtatni az adatbázis biztonsági rések vizsgálatához, válassza az eszköztár **vizsgálat** elemét:

        :::image type="content" source="media/sql-vulnerability-assessment/on-demand-vulnerability-scan.png" alt-text="Válassza a vizsgálat lehetőséget az SQL-erőforrás igény szerinti sebezhetőségi vizsgálatának futtatásához":::


  > [!NOTE]
  > A vizsgálat könnyű és biztonságos. A Futtatás néhány másodpercig tart, és a teljes egészében írásvédett. Nem végez semmilyen módosítást az adatbázisban.

## <a name="remediate-vulnerabilities"></a>Sebezhetőségek javítása

Ha a sebezhetőségi vizsgálat befejeződik, a jelentés megjelenik a Azure Portal. A jelentés a következőket mutatja be:

- A biztonsági állapot áttekintése
- A talált problémák száma, és
- A kockázatok súlyosságának összegzése
- A további vizsgálatok eredményeinek listája

:::image type="content" source="media/sql-vulnerability-assessment/sample-sql-vulnerabilities-report.png" alt-text="Az SQL sebezhetőségi felmérési ellenőrzőeszköztől származó sampy Scan-jelentés":::

A felderített biztonsági rések szervizelése:

1. Tekintse át az eredményeket, és határozza meg, hogy a jelentés eredményei közül melyik az igazi biztonsági probléma a környezetében.

1. Válassza ki az összes sikertelen eredményt, hogy megértsék annak hatását, és miért nem sikerült a biztonsági ellenőrzés.

    > [!TIP]
    > A megállapítások részleteit tartalmazó oldal a probléma megoldását elmagyarázó, végrehajtható szervizelési információkat tartalmaz.

    :::image type="content" source="media/sql-vulnerability-assessment/examining-vulnerability-findings.gif" alt-text="A sebezhetőségi vizsgálat eredményeinek vizsgálata":::

1. Az értékelés eredményeinek áttekintése során megadhatja, hogy az *eredmények a környezetében elfogadható* alapkonfigurációként legyenek megjelölve. Az alapkonfiguráció lényegében az eredmények jelentésének testreszabását jelenti. A következő vizsgálatokban az alapkonfigurációnak megfelelő eredményeket a rendszer átadja. Az alapkonfiguráció biztonsági állapotának megállapítása után a sebezhetőségi felmérés csak az alaptervtől való eltérésekről készít jelentést. Így a kapcsolódó problémákra koncentrálhat.

    :::image type="content" source="media/sql-vulnerability-assessment/baseline-approval.png" alt-text="A keresés alapkonfigurációként való jóváhagyása a jövőbeli keresésekhez":::

1. Ha megváltoztatja az alapterveket, használja a **vizsgálat** gombot egy igény szerinti vizsgálat futtatásához, és tekintse meg a testreszabott jelentést. Az alaptervhez hozzáadott összes megállapítás ekkor megjelenik az **átadott** üzenetben, amely azt jelzi, hogy az alapértékek változása miatt átadták őket.

    :::image type="content" source="media/sql-vulnerability-assessment/passed-per-custom-baseline.png" alt-text="Átadott értékelések, amelyek azt jelzik, hogy egyéni alapterv alapján adtak át":::

A biztonsági rések felmérésének vizsgálata mostantól biztosítható annak biztosítására, hogy az adatbázis magas szintű biztonságot őrizzen meg, és hogy a szervezeti szabályzatok teljesülnek. 

## <a name="advanced-capabilities"></a>Speciális képességek

### <a name="export-an-assessment-report"></a>Értékelési jelentés exportálása

Válassza a **vizsgálati eredmények exportálása** lehetőséget a vizsgálati eredmény letölthető Excel-jelentésének létrehozásához. Ez a jelentés egy Összegzés fület tartalmaz, amely az értékelés összegzését jeleníti meg. A jelentés tartalmazza az összes sikertelen ellenőrzést. Emellett tartalmaz egy **Results (eredmények** ) lapot is, amely az eredmények teljes készletét tartalmazza a vizsgálatból. Az eredmények tartalmazzák az összes futtatott ellenőrzést, valamint az eredmény részleteit.

### <a name="view-scan-history"></a>Vizsgálati előzmények megtekintése

A biztonsági rések felmérése ablaktáblán válassza a **vizsgálat előzményei** lehetőséget, hogy megtekintse az adatbázison korábban futtatott összes vizsgálat előzményeit. Válasszon ki egy adott vizsgálatot a listában a vizsgálat részletes eredményeinek megtekintéséhez.

## <a name="manage-vulnerability-assessments-programmatically"></a>A sebezhetőségi felmérések programozott kezelése

### <a name="using-azure-powershell"></a>Az Azure PowerShell használata

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> A PowerShell Azure Resource Manager modul továbbra is támogatott, de a jövőbeli fejlesztés az az. SQL modulhoz készült. Ezekhez a parancsmagokhoz lásd: [AzureRM. SQL](/powershell/module/AzureRM.Sql/). Az az modul és a AzureRm modulok parancsainak argumentumai lényegében azonosak.

Azure PowerShell parancsmagokkal programozott módon kezelheti a sebezhetőségi felméréseket. A támogatott parancsmagok a következők:

| Parancsmag neve hivatkozásként | Description |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Törli a sebezhetőségi felmérési szabály alaptervét.<br/>Először állítsa be az alaptervet, mielőtt ezt a parancsmagot használja a törléshez. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Törli egy adatbázis sebezhetőség-felmérési beállításait. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Törli a felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét.<br/>Először állítsa be az alaptervet, mielőtt ezt a parancsmagot használja a törléshez. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Törli a felügyelt adatbázis sebezhetőségi felmérésének beállításait. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Törli a felügyelt példány sebezhetőségi felmérésének beállításait. |
| [Átalakítás – AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Átalakítja a sebezhetőségi felmérés eredményeit egy adatbázis egy Excel-fájlba. |
| [Átalakítás – AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | A felügyelt adatbázisok sebezhetőségi felmérésének eredményét egy Excel-fájlba alakítja át. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Beolvassa egy adatbázis sebezhetőségi felmérési szabályának alaptervét egy adott szabályhoz. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Lekéri egy adott szabályhoz tartozó felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Az adott adatbázishoz tartozó összes sebezhetőségi felmérési vizsgálati rekord beolvasása. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Beolvassa az adott felügyelt adatbázishoz tartozó összes sebezhetőségi felmérési vizsgálati rekordot. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Egy adatbázis sebezhetőség-értékelési beállításait adja vissza. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Egy felügyelt adatbázis sebezhetőségi felmérési beállításait adja vissza. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Beállítja a sebezhetőségi felmérési szabály alaptervét. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Beállítja egy felügyelt adatbázis sebezhetőségi felmérési szabályának alaptervét. |
| [Start – AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Elindítja a sebezhetőségi felmérések vizsgálatának kezdetét egy adatbázison. |
| [Start – AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Egy felügyelt adatbázison elindítja a sebezhetőségi felmérések vizsgálatának kezdetét. |
| [Frissítés – AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Frissíti egy adatbázis sebezhetőség-felmérési beállításait. |
| [Frissítés – AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Frissíti egy felügyelt adatbázis sebezhetőségi felmérési beállításait. |
| [Frissítés – AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Frissíti egy felügyelt példány sebezhetőségi felmérésének beállításait. |
| &nbsp; | &nbsp; |

A parancsfájl-példákat lásd: az [Azure SQL sebezhetőségi felmérés PowerShell-támogatása](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support).

### <a name="using-resource-manager-templates"></a>Resource Manager-sablonok használata

A sebezhetőségi felmérés alapkonfigurációinak Azure Resource Manager sablonok használatával történő konfigurálásához használja a `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` típust.

Győződjön meg arról, hogy az `vulnerabilityAssessments` alaptervek hozzáadása előtt engedélyezte a használatát.

Az alábbi példa egy `master` `user` Resource Manager-sablonban lévő erőforrásokként az adatbázis-és a VA1143-VA2065 alapkonfiguráció-szabály definiálását szemlélteti:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

`master`Az adatbázis és `user` az adatbázis esetében az erőforrások nevei eltérően vannak definiálva:

- Master Database – "Name": "[Összefűzés (parameters (' server_name '), '/', parameters (' database_name '), '/default/VA2065/<b>Master</b>')]
- Felhasználói adatbázis – "név": "[Összefűzés (parameters (' server_name '), '/', parameters (' database_name '), '/default/VA2065/<b>default</b>')]",

A logikai típusok igaz/hamis értékre való kezeléséhez állítsa az alapkonfiguráció eredményét bináris bemenetként, például: "1"/"0".

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Következő lépések  

- További információ [Az Azure Defender for SQL szolgáltatásról](azure-defender-for-sql.md).
- További információ az [adatfelderítésről és a besorolásról](data-discovery-and-classification-overview.md).
- További információ a [sebezhetőségi felmérések vizsgálatának eredményeiről a tűzfalak és a virtuális hálózatok mögött elérhető Storage-fiókkal](sql-database-vulnerability-assessment-storage.md).